<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1, viewport-fit=cover" />
  <title>ARSLAN ‚Ä¢ FACTURAS R√ÅPIDAS (AUTO VOCAB)</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>

  <!-- XLSX (export/import opcional) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <div class="app">

    <!-- TOP BAR -->
    <header class="topbar">
      <div class="brand">
        <div class="kiwi"></div>
        <div class="brandText">
          <div class="title">ARSLAN ‚Ä¢ FACTURAS R√ÅPIDAS</div>
          <div class="sub">Autocompletar real desde tu vocabulario ARSLAN LISTAS ‚úÖ</div>
        </div>
      </div>

      <div class="topActions">
        <button class="btn ghost" id="btnTheme" title="Modo claro/oscuro">üåó</button>
        <button class="btn ghost" id="btnHelp" title="Atajos y ayuda">‚ùî</button>
      </div>
    </header>

    <!-- MAIN GRID -->
    <main class="grid">

      <!-- PANEL IZQUIERDO -->
      <section class="card">
        <div class="cardTitle">Datos de factura</div>

        <div class="formGrid">
          <div class="field">
            <label>N¬∫ Factura</label>
            <input id="invNumber" class="input" type="text" placeholder="FA-202601261530" />
            <div class="hint">Auto si lo dejas vac√≠o</div>
          </div>

          <div class="field">
            <label>Fecha</label>
            <input id="invDate" class="input" type="date" />
          </div>

          <div class="field">
            <label>Cliente</label>
            <input id="invClient" class="input" type="text" placeholder="RIVIERA / GOLDEN / etc..." />
          </div>

          <div class="field">
            <label>Notas</label>
            <textarea id="invNotes" class="input area" placeholder="Observaciones..."></textarea>
          </div>
        </div>

        <div class="row">
          <button class="btn" id="btnNew">‚ûï Nueva</button>
          <button class="btn soft" id="btnSave">üíæ Guardar</button>
          <button class="btn ghost" id="btnClear">üßπ Limpiar</button>
        </div>

        <div class="divider"></div>

        <div class="cardTitle">Pegar lista r√°pida</div>
        <div class="hint">
          Pega l√≠neas tipo:
          <span class="chip">3 TOMATE PERA</span>
          <span class="chip">2 LIM√ìN</span>
          <span class="chip">1,5 KILO JENGIBRE</span>
          <br/>
          Tambi√©n vale: <span class="chip">TOMATE PERA</span> (cantidad 1)
        </div>

        <textarea id="bulkBox" class="input area bulk" placeholder="Pega aqu√≠ tu lista..."></textarea>
        <div class="row">
          <button class="btn" id="btnBulk">‚ö° Insertar filas</button>
          <button class="btn ghost" id="btnBulkClear">üóëÔ∏è Vaciar</button>
        </div>

        <div class="divider"></div>

        <div class="cardTitle">Totales</div>
        <div class="totals">
          <div class="totRow">
            <span>Subtotal</span>
            <b id="tSubtotal">0,00 ‚Ç¨</b>
          </div>
          <div class="totRow">
            <span>IVA (%)</span>
            <div class="inline">
              <input id="invVat" class="input mini" type="number" inputmode="decimal" step="0.01" value="4" />
              <span class="muted">%</span>
            </div>
          </div>
          <div class="totRow">
            <span>IVA ‚Ç¨</span>
            <b id="tVat">0,00 ‚Ç¨</b>
          </div>
          <div class="totRow grand">
            <span>TOTAL</span>
            <b id="tTotal">0,00 ‚Ç¨</b>
          </div>
        </div>

        <div class="row">
          <button class="btn" id="btnPDF">üìÑ PDF</button>
          <button class="btn soft" id="btnWA">üì≤ WhatsApp</button>
        </div>

        <div class="divider"></div>

        <div class="cardTitle">Historial</div>
        <div class="hint">Guarda y luego podr√°s cargar / exportar / borrar.</div>

        <div class="row">
          <button class="btn ghost" id="btnExport">‚¨áÔ∏è Export JSON</button>
          <label class="btn ghost fileBtn">
            ‚¨ÜÔ∏è Import JSON
            <input id="importFile" type="file" accept="application/json" />
          </label>
        </div>

        <div id="history" class="history"></div>
      </section>

      <!-- PANEL DERECHO -->
      <section class="card wide">
        <div class="cardTitle">L√≠neas de factura</div>

        <div class="hint">
          ‚úÖ <b>Enter</b> = siguiente campo ‚Ä¢ ‚úÖ Enter en precio al final = <b>nueva fila</b> ‚Ä¢
          ‚úÖ <b>Ctrl + Enter</b> = nueva fila ‚Ä¢ ‚úÖ <b>Alt + Supr</b> = borrar fila
        </div>

        <div class="tableWrap">
          <table class="table" id="linesTable">
            <thead>
              <tr>
                <th class="colDel"></th>
                <th class="colName">Producto</th>
                <th class="colQty">Cant.</th>
                <th class="colPrice">Precio</th>
                <th class="colUnit">Unidad</th>
                <th class="colTotal">Total</th>
              </tr>
            </thead>
            <tbody id="linesBody"></tbody>
          </table>
        </div>

        <div class="row end">
          <button class="btn" id="btnAddLine">‚ûï A√±adir fila</button>
          <button class="btn ghost" id="btnResetLines">‚Ü©Ô∏è Reset filas</button>
        </div>

        <div class="divider"></div>

        <div class="cardTitle">Vista r√°pida (resumen)</div>
        <pre class="preview" id="preview"></pre>

      </section>
    </main>

  </div>

  <!-- MODAL AYUDA -->
  <div class="modal" id="modalHelp">
    <div class="modalCard">
      <div class="modalHead">
        <b>Atajos</b>
        <button class="btn ghost" id="btnCloseHelp">‚úñ</button>
      </div>

      <div class="modalBody">
        <ul class="list">
          <li><b>Enter</b> ‚Üí pasa al siguiente campo</li>
          <li><b>Enter</b> en precio (√∫ltima fila) ‚Üí crea nueva fila</li>
          <li><b>Ctrl + Enter</b> ‚Üí nueva fila en cualquier sitio</li>
          <li><b>Alt + Supr</b> ‚Üí borra fila actual</li>
          <li><b>Flechas ‚Üë ‚Üì</b> en producto ‚Üí navega sugerencias</li>
          <li><b>Enter</b> con sugerencia ‚Üí selecciona producto</li>
        </ul>

        <div class="hint">
          El autocompletar carga autom√°ticamente el vocabulario si tu app de LISTAS y esta de FACTURAS est√°n en el mismo dominio:
          <span class="chip">shaniwaris80-crypto.github.io</span>
        </div>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
