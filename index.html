<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>ARSLAN PRO KIWI 10.4</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="logo.png">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
<header>
  <img src="logo.png" alt="Kiwi" class="logo-small">
  <h1>ARSLAN PRO 🥝 KIWI</h1>
</header>

<nav>
  <button class="tab active" data-tab="factura">Factura</button>
  <button class="tab" data-tab="clientes">Clientes</button>
  <button class="tab" data-tab="productos">Productos</button>
  <button class="tab" data-tab="facturas">Historial</button>
  <button class="tab" data-tab="pendientes">Pendientes</button>
  <button class="tab" data-tab="resumen">Resumen</button>
</nav>

<main>
  <!-- FACTURA -->
  <section class="panel active" data-tab-panel="factura">
    <h2>🧾 Nueva Factura</h2>
    <div class="row">
      <div>
        <label>Cliente:</label>
        <select id="selCliente"></select>
        <input id="cliNombre" placeholder="Nombre cliente">
        <input id="cliNif" placeholder="NIF/CIF">
        <input id="cliDir" placeholder="Dirección">
        <input id="cliTel" placeholder="Teléfono">
        <input id="cliEmail" placeholder="Email">
      </div>
      <div>
        <label>Proveedor:</label>
        <input id="provNombre" placeholder="Tu nombre / empresa">
        <input id="provNif" placeholder="NIF">
        <input id="provDir" placeholder="Dirección">
        <input id="provTel" placeholder="Teléfono">
        <input id="provEmail" placeholder="Email">
      </div>
    </div>

    <table class="tabla-lineas">
      <thead>
        <tr>
          <th>Producto</th><th>Modo</th><th>Cant</th><th>Bruto</th><th>Tara</th>
          <th>Neto</th><th>Precio</th><th>Origen</th><th>Importe</th><th></th>
        </tr>
      </thead>
      <tbody id="lineasBody"></tbody>
    </table>

    <div class="actions">
      <button id="btnAddLinea">+ Línea</button>
      <button id="btnVaciarLineas">Vaciar</button>
    </div>

    <div class="totales">
      <label><input type="checkbox" id="chkTransporte"> Transporte +10%</label>
      <label><input type="checkbox" id="chkIVA4"> IVA 4%</label>
      <div><strong>Subtotal:</strong> <span id="subtotal">0,00 €</span></div>
      <div><strong>Transporte:</strong> <span id="transp">0,00 €</span></div>
      <div><strong>IVA:</strong> <span id="iva">0,00 €</span></div>
      <div><strong>Total:</strong> <span id="total">0,00 €</span></div>
      <div><strong>Pagado:</strong> <input id="pagado" type="number" step="0.01" value="0"></div>
      <div><strong>Pendiente:</strong> <span id="pendiente">0,00 €</span></div>
      <div><strong>Estado:</strong>
        <select id="estado">
          <option value="pendiente">Pendiente</option>
          <option value="parcial">Parcial</option>
          <option value="pagado">Pagado</option>
        </select>
      </div>
      <div><strong>Método:</strong>
        <select id="metodoPago">
          <option>Efectivo</option><option>Tarjeta</option><option>Transferencia</option>
        </select>
      </div>
      <textarea id="observaciones" placeholder="Observaciones o notas"></textarea>
      <div class="row">
        <button id="btnGuardar">💾 Guardar</button>
        <button id="btnImprimir">🖨 PDF</button>
        <button id="btnNueva">🧾 Nueva</button>
      </div>
    </div>

    <div id="printArea">
      <header id="pdf-header">
        <img src="logo.png" class="logo-small">
        <h2>FACTURA</h2>
      </header>
      <div id="p-info">
        <div id="p-prov"></div>
        <div id="p-cli"></div>
      </div>
      <table id="p-tabla">
        <thead>
          <tr><th>Producto</th><th>Modo</th><th>Cant</th><th>Bruto</th><th>Tara</th><th>Neto</th><th>Precio</th><th>Origen</th><th>Total</th></tr>
        </thead>
        <tbody></tbody>
      </table>
      <footer>
        <div id="p-sub"></div><div id="p-tra"></div><div id="p-iva"></div><div id="p-tot"></div>
        <canvas id="p-qr"></canvas>
        <div id="pdf-foot-note">IVA incluido en los precios.</div>
      </footer>
    </div>
  </section>

  <!-- CLIENTES -->
  <section class="panel" data-tab-panel="clientes">
    <h2>👤 Clientes</h2>
    <div class="row">
      <input id="buscarCliente" placeholder="Buscar cliente...">
      <button id="btnAddCliente">+ Añadir</button>
    </div>
    <div id="listaClientes"></div>
  </section>

  <!-- PRODUCTOS -->
  <section class="panel" data-tab-panel="productos">
    <h2>🍎 Productos</h2>
    <div class="row">
      <input id="buscarProducto" placeholder="Buscar producto...">
    </div>
    <div id="listaProductos"></div>
  </section>

  <!-- FACTURAS -->
  <section class="panel" data-tab-panel="facturas">
    <h2>📜 Historial</h2>
    <input id="buscaCliente" placeholder="Buscar cliente...">
    <select id="filtroEstado">
      <option value="todas">Todas</option>
      <option value="pagado">Pagadas</option>
      <option value="pendiente">Pendientes</option>
      <option value="parcial">Parciales</option>
    </select>
    <div id="listaFacturas"></div>
  </section>

  <!-- PENDIENTES -->
  <section class="panel" data-tab-panel="pendientes">
    <h2>💰 Pendientes de Cobro</h2>
    <table id="tblPendientes">
      <thead><tr><th>Cliente</th><th>#</th><th>Total</th><th>Última</th><th>Acciones</th></tr></thead>
      <tbody></tbody>
    </table>
    <div class="resumen">Pendiente global: <span id="resGlobal">0,00 €</span></div>
    <div class="row">
      <button id="btnResetCliente" class="ghost">Reset Cliente</button>
      <button id="btnResetGlobal">Reset Global</button>
    </div>
  </section>

  <!-- RESUMEN -->
  <section class="panel" data-tab-panel="resumen">
    <h2>📊 Resumen de Ventas</h2>
    <div class="kpis">
      <div>Hoy: <span id="vHoy"></span></div>
      <div>Semana: <span id="vSemana"></span></div>
      <div>Mes: <span id="vMes"></span></div>
      <div>Total: <span id="vTotal"></span></div>
    </div>
    <canvas id="chartDiario"></canvas>
    <canvas id="chartMensual"></canvas>
    <canvas id="chartTop"></canvas>
    <div class="row actions">
      <button id="btnExportVentas">Exportar CSV</button>
    </div>
    <table id="tblVentasCliente">
      <thead><tr><th>Cliente</th><th>Hoy</th><th>Semana</th><th>Mes</th><th>Total</th></tr></thead>
      <tbody></tbody>
    </table>
  </section>
</main>

<script type="module" src="app.js"></script>
</body>
</html>
